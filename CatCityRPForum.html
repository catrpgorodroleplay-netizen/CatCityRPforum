<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CatCityRP - —Ñ–æ—Ä—É–º Minecraft</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #1a1a2e, #16213e);
            color: #fff;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background: rgba(0, 0, 0, 0.7);
            padding: 15px 0;
            border-bottom: 2px solid #0f3460;
            margin-bottom: 20px;
            border-radius: 10px;
            display: none;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 28px;
            font-weight: bold;
            color: #e94560;
            text-shadow: 0 0 10px rgba(233, 69, 96, 0.5);
        }

        nav ul {
            display: flex;
            list-style: none;
        }

        nav ul li {
            margin-left: 20px;
        }

        nav ul li a {
            color: #fff;
            text-decoration: none;
            padding: 8px 15px;
            border-radius: 5px;
            transition: all 0.3s;
        }

        nav ul li a:hover, nav ul li a.active {
            background: #0f3460;
        }

        .page {
            display: none;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .page.active {
            display: block;
        }

        .auth-container {
            max-width: 400px;
            margin: 50px auto;
            background: rgba(255, 255, 255, 0.1);
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        h2 {
            text-align: center;
            margin-bottom: 20px;
            color: #e94560;
        }

        .form-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 5px;
        }

        input, select, textarea {
            width: 100%;
            padding: 10px;
            border: none;
            border-radius: 5px;
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
            border: 1px solid #0f3460;
        }

        button {
            background: #e94560;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
        }

        button:hover {
            background: #c2334d;
            transform: translateY(-2px);
        }

        .tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 1px solid #0f3460;
        }

        .tab {
            padding: 10px 20px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
        }

        .tab.active {
            border-bottom: 3px solid #e94560;
        }

        .post {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            border-left: 4px solid #0f3460;
        }

        .post-header {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }

        .post-avatar {
            font-size: 30px;
            margin-right: 10px;
        }

        .post-title {
            font-size: 18px;
            font-weight: bold;
            color: #e94560;
        }

        .post-content {
            margin-bottom: 10px;
        }

        .post-actions {
            display: flex;
            justify-content: space-between;
        }

        .comment {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 5px;
            padding: 10px;
            margin: 10px 0;
            border-left: 2px solid #0f3460;
        }

        .comment-header {
            display: flex;
            align-items: center;
            margin-bottom: 5px;
        }

        .comment-avatar {
            font-size: 20px;
            margin-right: 10px;
            cursor: pointer;
        }

        .comment-author {
            font-weight: bold;
            color: #e94560;
        }

        .messages-layout {
            display: flex;
            height: 600px;
            gap: 20px;
        }

        .conversations-sidebar {
            width: 300px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            padding: 15px;
            overflow-y: auto;
        }

        .conversations-list {
            max-height: 100%;
            overflow-y: auto;
        }

        .message-user {
            display: flex;
            align-items: center;
            padding: 10px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 5px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .message-user:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .message-user.active {
            background: rgba(233, 69, 96, 0.2);
            border-left: 3px solid #e94560;
        }

        .message-avatar {
            font-size: 24px;
            margin-right: 10px;
            cursor: pointer;
        }

        .chat-area {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .chat-container {
            display: flex;
            flex-direction: column;
            height: 100%;
            border: 1px solid #0f3460;
            border-radius: 10px;
            overflow: hidden;
        }

        .chat-header {
            background: rgba(0, 0, 0, 0.5);
            padding: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .chat-user-info {
            display: flex;
            align-items: center;
        }

        .chat-avatar {
            font-size: 24px;
            margin-right: 10px;
            cursor: pointer;
        }

        .chat-messages {
            flex: 1;
            padding: 15px;
            overflow-y: auto;
            background: rgba(255, 255, 255, 0.05);
            display: flex;
            flex-direction: column;
        }

        .message {
            margin-bottom: 15px;
            padding: 10px 15px;
            border-radius: 15px;
            max-width: 70%;
            word-wrap: break-word;
        }

        .message.own {
            background: rgba(233, 69, 96, 0.3);
            align-self: flex-end;
            border-bottom-right-radius: 5px;
        }

        .message.other {
            background: rgba(15, 52, 96, 0.3);
            align-self: flex-start;
            border-bottom-left-radius: 5px;
        }

        .message-time {
            font-size: 11px;
            opacity: 0.7;
            margin-top: 5px;
            text-align: right;
        }

        .chat-input {
            display: flex;
            padding: 15px;
            background: rgba(0, 0, 0, 0.5);
            align-items: flex-end;
        }

        .chat-input textarea {
            flex: 1;
            margin-right: 10px;
            resize: none;
            height: 60px;
            min-height: 60px;
            max-height: 120px;
            font-family: inherit;
        }

        .chat-input button {
            width: auto;
            padding: 10px 20px;
            height: 60px;
        }

        .profile-container {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .profile-avatar {
            font-size: 80px;
            margin-bottom: 20px;
        }

        .avatar-selector {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 10px;
            margin: 20px 0;
        }

        .avatar-option {
            font-size: 30px;
            text-align: center;
            padding: 10px;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .avatar-option:hover, .avatar-option.selected {
            background: rgba(233, 69, 96, 0.3);
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: #1a1a2e;
            padding: 20px;
            border-radius: 10px;
            width: 90%;
            max-width: 500px;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .close-modal {
            background: none;
            border: none;
            color: #fff;
            font-size: 20px;
            cursor: pointer;
            width: auto;
        }

        .user-actions {
            display: flex;
            justify-content: space-around;
            margin-top: 15px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .user-actions button {
            width: 45%;
        }

        .error {
            color: #e94560;
            margin-top: 5px;
            font-size: 14px;
        }

        .success {
            color: #4CAF50;
            margin-top: 5px;
            font-size: 14px;
        }

        .admin-badge {
            background: #e94560;
            color: white;
            padding: 2px 5px;
            border-radius: 3px;
            font-size: 12px;
            margin-left: 5px;
        }

        .auto-login-notice {
            text-align: center;
            margin-top: 20px;
            padding: 10px;
            background: rgba(15, 52, 96, 0.3);
            border-radius: 5px;
            font-size: 14px;
        }

        .blocked-notice {
            background: rgba(255, 0, 0, 0.2);
            padding: 10px;
            border-radius: 5px;
            text-align: center;
            margin: 10px 0;
        }

        .no-conversations {
            text-align: center;
            padding: 20px;
            color: #aaa;
        }

        .no-chat-selected {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100%;
            color: #aaa;
            font-size: 18px;
        }

        .blocked-badge {
            background: #ff4757;
            color: white;
            padding: 2px 6px;
            border-radius: 10px;
            font-size: 10px;
            margin-left: auto;
        }

        .deleted-account {
            color: #888;
            font-style: italic;
        }

        .delete-account-btn {
            background: #ff4757;
            margin-top: 20px;
        }

        .delete-account-btn:hover {
            background: #ff3742;
        }

        .danger-zone {
            margin-top: 30px;
            padding: 20px;
            border: 2px solid #ff4757;
            border-radius: 10px;
            background: rgba(255, 71, 87, 0.1);
        }

        .danger-zone h3 {
            color: #ff4757;
            margin-bottom: 15px;
        }

        .confirm-delete {
            background: #ff4757;
            width: 100%;
        }

        .confirm-delete:hover {
            background: #ff3742;
        }

        .cancel-delete {
            background: #576574;
            width: 100%;
        }

        .cancel-delete:hover {
            background: #4a5766;
        }
    </style>
</head>
<body>
    <div class="container">
        <header id="main-header">
            <div class="header-content">
                <div class="logo">CatCityRP</div>
                <nav>
                    <ul>
                        <li><a href="#" class="nav-link active" data-page="posts">–ü–æ—Å—Ç—ã</a></li>
                        <li><a href="#" class="nav-link" data-page="messages">–°–æ–æ–±—â–µ–Ω–∏—è</a></li>
                        <li><a href="#" class="nav-link" data-page="profile">–ü—Ä–æ—Ñ–∏–ª—å</a></li>
                        <li><a href="#" id="logout-btn">–í—ã–π—Ç–∏</a></li>
                    </ul>
                </nav>
            </div>
        </header>

        <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏/—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ -->
        <div id="auth-page" class="page active">
            <div class="auth-container">
                <div class="tabs">
                    <div class="tab active" data-tab="login">–í—Ö–æ–¥</div>
                    <div class="tab" data-tab="register">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</div>
                </div>

                <div id="login-form" class="auth-form">
                    <h2>–í—Ö–æ–¥ –≤ –∞–∫–∫–∞—É–Ω—Ç</h2>
                    <div class="form-group">
                        <label for="login-username">–õ–æ–≥–∏–Ω</label>
                        <input type="text" id="login-username" placeholder="–í–≤–µ–¥–∏—Ç–µ –ª–æ–≥–∏–Ω">
                    </div>
                    <div class="form-group">
                        <label for="login-password">–ü–∞—Ä–æ–ª—å</label>
                        <input type="password" id="login-password" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å">
                    </div>
                    <button id="login-btn">–í–æ–π—Ç–∏</button>
                    <div id="login-error" class="error"></div>
                </div>

                <div id="register-form" class="auth-form" style="display: none;">
                    <h2>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∞–∫–∫–∞—É–Ω—Ç–∞</h2>
                    <div class="form-group">
                        <label for="register-username">–õ–æ–≥–∏–Ω</label>
                        <input type="text" id="register-username" placeholder="–ü—Ä–∏–¥—É–º–∞–π—Ç–µ –ª–æ–≥–∏–Ω">
                    </div>
                    <div class="form-group">
                        <label for="register-password">–ü–∞—Ä–æ–ª—å</label>
                        <input type="password" id="register-password" placeholder="–ü—Ä–∏–¥—É–º–∞–π—Ç–µ –ø–∞—Ä–æ–ª—å">
                    </div>
                    <div class="form-group">
                        <label for="register-confirm">–ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –ø–∞—Ä–æ–ª—å</label>
                        <input type="password" id="register-confirm" placeholder="–ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –ø–∞—Ä–æ–ª—å">
                    </div>
                    <button id="register-btn">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
                    <div id="register-error" class="error"></div>
                </div>
            </div>
        </div>

        <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–æ—Å—Ç–æ–≤ -->
        <div id="posts-page" class="page">
            <h2>–ü–æ—Å—Ç—ã</h2>
            <div id="posts-container"></div>
            <button id="create-post-btn" style="display: none;">–°–æ–∑–¥–∞—Ç—å –ø–æ—Å—Ç</button>
        </div>

        <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Å–æ–æ–±—â–µ–Ω–∏–π -->
        <div id="messages-page" class="page">
            <h2>–°–æ–æ–±—â–µ–Ω–∏—è</h2>
            <div class="messages-layout">
                <div class="conversations-sidebar">
                    <h3>–î–∏–∞–ª–æ–≥–∏</h3>
                    <div class="conversations-list" id="conversations-list">
                        <!-- –°–ø–∏—Å–æ–∫ –¥–∏–∞–ª–æ–≥–æ–≤ –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
                    </div>
                    <div id="no-conversations" class="no-conversations" style="display: none;">
                        –£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –±–µ—Å–µ–¥. –ù–∞—á–Ω–∏—Ç–µ –æ–±—â–µ–Ω–∏–µ —Å –∫–µ–º-–Ω–∏–±—É–¥—å!
                    </div>
                </div>
                <div class="chat-area">
                    <div id="chat-container" class="chat-container">
                        <div class="no-chat-selected" id="no-chat-selected">
                            –í—ã–±–µ—Ä–∏—Ç–µ –¥–∏–∞–ª–æ–≥ –¥–ª—è –Ω–∞—á–∞–ª–∞ –æ–±—â–µ–Ω–∏—è
                        </div>
                        <div id="active-chat" style="display: none;">
                            <div class="chat-header">
                                <div class="chat-user-info" id="chat-user-info"></div>
                                <button id="delete-chat-btn">–£–¥–∞–ª–∏—Ç—å —á–∞—Ç</button>
                            </div>
                            <div class="chat-messages" id="chat-messages"></div>
                            <div class="chat-input">
                                <textarea id="message-input" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..."></textarea>
                                <button id="send-message-btn">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø—Ä–æ—Ñ–∏–ª—è -->
        <div id="profile-page" class="page">
            <h2>–ü—Ä–æ—Ñ–∏–ª—å</h2>
            <div class="profile-container">
                <div class="profile-avatar" id="profile-avatar-display">üò∫</div>
                <div class="form-group">
                    <label for="profile-username">–õ–æ–≥–∏–Ω</label>
                    <input type="text" id="profile-username" readonly>
                </div>
                <div class="form-group">
                    <label for="profile-description">–û–ø–∏—Å–∞–Ω–∏–µ</label>
                    <textarea id="profile-description" rows="3" placeholder="–†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –æ —Å–µ–±–µ"></textarea>
                </div>
                <h3>–í—ã–±–µ—Ä–∏—Ç–µ –∞–≤–∞—Ç–∞—Ä–∫—É</h3>
                <div class="avatar-selector" id="avatar-selector">
                    <!-- –ê–≤–∞—Ç–∞—Ä—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JS -->
                </div>
                <button id="save-profile-btn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è</button>
                <div id="profile-message" class="success"></div>

                <!-- –ó–æ–Ω–∞ –æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –∞–∫–∫–∞—É–Ω—Ç–∞ -->
                <div class="danger-zone">
                    <h3>‚ö†Ô∏è –û–ø–∞—Å–Ω–∞—è –∑–æ–Ω–∞</h3>
                    <p>–£–¥–∞–ª–µ–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–∞ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –æ—Ç–º–µ–Ω–∏—Ç—å. –í—Å–µ –≤–∞—à–∏ –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –±–µ–∑–≤–æ–∑–≤—Ä–∞—Ç–Ω–æ —É–¥–∞–ª–µ–Ω—ã.</p>
                    <button id="delete-account-btn" class="delete-account-btn">–£–¥–∞–ª–∏—Ç—å –º–æ–π –∞–∫–∫–∞—É–Ω—Ç</button>
                </div>
            </div>
        </div>

        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ—Å—Ç–∞ -->
        <div id="create-post-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>–°–æ–∑–¥–∞—Ç—å –ø–æ—Å—Ç</h3>
                    <button class="close-modal">&times;</button>
                </div>
                <div class="form-group">
                    <label for="post-title">–ù–∞–∑–≤–∞–Ω–∏–µ –ø–æ—Å—Ç–∞</label>
                    <input type="text" id="post-title" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ">
                </div>
                <div class="form-group">
                    <label for="post-content">–û–ø–∏—Å–∞–Ω–∏–µ</label>
                    <textarea id="post-content" rows="5" placeholder="–í–≤–µ–¥–∏—Ç–µ –æ–ø–∏—Å–∞–Ω–∏–µ"></textarea>
                </div>
                <div class="form-group">
                    <label>–ê–≤–∞—Ç–∞—Ä–∫–∞ –ø–æ—Å—Ç–∞</label>
                    <div class="avatar-selector" id="post-avatar-selector">
                        <!-- –ê–≤–∞—Ç–∞—Ä—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JS -->
                    </div>
                </div>
                <button id="submit-post-btn">–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å</button>
                <div id="post-error" class="error"></div>
            </div>
        </div>

        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ—Å—Ç–∞ —Å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏ -->
        <div id="post-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 id="modal-post-title"></h3>
                    <button class="close-modal">&times;</button>
                </div>
                <div class="post-header">
                    <div class="post-avatar" id="modal-post-avatar"></div>
                    <div class="post-title" id="modal-post-title-text"></div>
                </div>
                <div class="post-content" id="modal-post-content"></div>
                <div id="post-comments"></div>
                <div class="form-group">
                    <textarea id="comment-input" rows="3" placeholder="–ù–∞–ø–∏—à–∏—Ç–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π..."></textarea>
                    <button id="submit-comment-btn">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</button>
                </div>
            </div>
        </div>

        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–µ–π—Å—Ç–≤–∏–π —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º -->
        <div id="user-actions-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>–î–µ–π—Å—Ç–≤–∏—è —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º</h3>
                    <button class="close-modal">&times;</button>
                </div>
                <div class="user-actions">
                    <button id="block-user-btn">–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å</button>
                    <button id="unblock-user-btn">–†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å</button>
                    <button id="start-chat-btn">–ù–∞—á–∞—Ç—å –æ–±—â–µ–Ω–∏–µ</button>
                    <button id="delete-user-btn" style="display: none; background: #ff4757;">–£–¥–∞–ª–∏—Ç—å –∞–∫–∫–∞—É–Ω—Ç</button>
                </div>
            </div>
        </div>

        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —É–¥–∞–ª–µ–Ω–∏—è –∞–∫–∫–∞—É–Ω—Ç–∞ -->
        <div id="confirm-delete-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–∏—è</h3>
                    <button class="close-modal">&times;</button>
                </div>
                <div class="form-group">
                    <p id="delete-confirm-text">–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –∞–∫–∫–∞—É–Ω—Ç? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –æ—Ç–º–µ–Ω–∏—Ç—å.</p>
                </div>
                <div class="user-actions">
                    <button id="confirm-delete-btn" class="confirm-delete">–î–∞, —É–¥–∞–ª–∏—Ç—å</button>
                    <button id="cancel-delete-btn" class="cancel-delete">–û—Ç–º–µ–Ω–∞</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // –î–∞–Ω–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        const appData = {
            currentUser: null,
            users: JSON.parse(localStorage.getItem('catcityrp_users')) || [],
            posts: JSON.parse(localStorage.getItem('catcityrp_posts')) || [],
            conversations: JSON.parse(localStorage.getItem('catcityrp_conversations')) || [],
            blockedUsers: JSON.parse(localStorage.getItem('catcityrp_blocked')) || {},
            deletedUsers: JSON.parse(localStorage.getItem('catcityrp_deleted')) || [],
            avatars: ['üò∫', 'üò∏', 'üòπ', 'üòª', 'üòº', 'üòΩ', 'üôÄ', 'üòø', 'üòæ', 'üê±', 'üêà', 'ü¶Å', 'üêØ', 'üêÖ', 'üêÜ'],
            currentChat: null
        };

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        function initApp() {
            // –°–æ–∑–¥–∞–µ–º –∞–∫–∫–∞—É–Ω—Ç –∞–¥–º–∏–Ω–∞, –µ—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç
            if (!appData.users.find(user => user.username === 'CREATE')) {
                appData.users.push({
                    username: 'CREATE',
                    password: '01239876cat',
                    isAdmin: true,
                    avatar: 'üòº',
                    description: '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä CatCityRP'
                });
                saveUsers();
            }

            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—Ö–æ–¥ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
            const savedUser = localStorage.getItem('catcityrp_currentUser');
            if (savedUser) {
                const userData = JSON.parse(savedUser);
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤ –±–∞–∑–µ –∏ –Ω–µ —É–¥–∞–ª–µ–Ω –ª–∏ –æ–Ω
                const userExists = appData.users.find(u => u.username === userData.username && u.password === userData.password);
                const isDeleted = appData.deletedUsers.includes(userData.username);
                
                if (userExists && !isDeleted) {
                    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—Ö–æ–¥–∏–º –≤ –∞–∫–∫–∞—É–Ω—Ç
                    appData.currentUser = userData;
                    showMainPages();
                } else {
                    // –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω –∏–ª–∏ —É–¥–∞–ª–µ–Ω, —É–¥–∞–ª—è–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
                    localStorage.removeItem('catcityrp_currentUser');
                    showAuthPage();
                }
            } else {
                showAuthPage();
            }

            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π
            initEventListeners();
            renderAvatarSelector();
        }

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
        function saveUsers() {
            localStorage.setItem('catcityrp_users', JSON.stringify(appData.users));
        }

        function savePosts() {
            localStorage.setItem('catcityrp_posts', JSON.stringify(appData.posts));
        }

        function saveConversations() {
            localStorage.setItem('catcityrp_conversations', JSON.stringify(appData.conversations));
        }

        function saveBlockedUsers() {
            localStorage.setItem('catcityrp_blocked', JSON.stringify(appData.blockedUsers));
        }

        function saveDeletedUsers() {
            localStorage.setItem('catcityrp_deleted', JSON.stringify(appData.deletedUsers));
        }

        function saveCurrentUser() {
            localStorage.setItem('catcityrp_currentUser', JSON.stringify(appData.currentUser));
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–¥–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω—è—è)
        function isUserBlocked(username) {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–ª –ª–∏ —Ç–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —ç—Ç–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            const blockedByMe = appData.blockedUsers[appData.currentUser.username] && 
                               appData.blockedUsers[appData.currentUser.username].includes(username);
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–ª –ª–∏ —ç—Ç–æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            const blockedByThem = appData.blockedUsers[username] && 
                                 appData.blockedUsers[username].includes(appData.currentUser.username);
            
            return blockedByMe || blockedByThem;
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞, —É–¥–∞–ª–µ–Ω –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
        function isUserDeleted(username) {
            return appData.deletedUsers.includes(username);
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
        function showAuthPage() {
            document.getElementById('auth-page').classList.add('active');
            document.getElementById('posts-page').classList.remove('active');
            document.getElementById('messages-page').classList.remove('active');
            document.getElementById('profile-page').classList.remove('active');
            document.getElementById('main-header').style.display = 'none';
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å –æ—Å–Ω–æ–≤–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        function showMainPages() {
            document.getElementById('auth-page').classList.remove('active');
            document.getElementById('posts-page').classList.add('active');
            document.getElementById('messages-page').classList.remove('active');
            document.getElementById('profile-page').classList.remove('active');
            document.getElementById('main-header').style.display = 'block';

            // –ü–æ–∫–∞–∑–∞—Ç—å –∫–Ω–æ–ø–∫—É —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ—Å—Ç–∞ –¥–ª—è –∞–¥–º–∏–Ω–∞
            if (appData.currentUser.isAdmin) {
                document.getElementById('create-post-btn').style.display = 'block';
            } else {
                document.getElementById('create-post-btn').style.display = 'none';
            }

            renderPosts();
            renderProfile();
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π
        function initEventListeners() {
            // –ù–∞–≤–∏–≥–∞—Ü–∏—è
            document.querySelectorAll('.nav-link').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const page = this.getAttribute('data-page');
                    
                    document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
                    this.classList.add('active');
                    
                    document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
                    document.getElementById(`${page}-page`).classList.add('active');
                    
                    if (page === 'messages') {
                        renderConversations();
                    }
                });
            });

            // –í–∫–ª–∞–¥–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏/—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    
                    const tabName = this.getAttribute('data-tab');
                    document.getElementById('login-form').style.display = tabName === 'login' ? 'block' : 'none';
                    document.getElementById('register-form').style.display = tabName === 'register' ? 'block' : 'none';
                });
            });

            // –ö–Ω–æ–ø–∫–∞ –≤—Ö–æ–¥–∞
            document.getElementById('login-btn').addEventListener('click', login);

            // –ö–Ω–æ–ø–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
            document.getElementById('register-btn').addEventListener('click', register);

            // –ö–Ω–æ–ø–∫–∞ –≤—ã—Ö–æ–¥–∞
            document.getElementById('logout-btn').addEventListener('click', logout);

            // –ö–Ω–æ–ø–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ—Å—Ç–∞
            document.getElementById('create-post-btn').addEventListener('click', showCreatePostModal);

            // –ö–Ω–æ–ø–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø–æ—Å—Ç–∞
            document.getElementById('submit-post-btn').addEventListener('click', createPost);

            // –ö–Ω–æ–ø–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è
            document.getElementById('submit-comment-btn').addEventListener('click', addComment);

            // –ö–Ω–æ–ø–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è
            document.getElementById('save-profile-btn').addEventListener('click', saveProfile);

            // –ö–Ω–æ–ø–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è
            document.getElementById('send-message-btn').addEventListener('click', sendMessage);

            // –ö–Ω–æ–ø–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è —á–∞—Ç–∞
            document.getElementById('delete-chat-btn').addEventListener('click', deleteChat);

            // –ö–Ω–æ–ø–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –∞–∫–∫–∞—É–Ω—Ç–∞
            document.getElementById('delete-account-btn').addEventListener('click', showDeleteAccountModal);

            // –ö–Ω–æ–ø–∫–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —É–¥–∞–ª–µ–Ω–∏—è
            document.getElementById('confirm-delete-btn').addEventListener('click', confirmDeleteAccount);
            document.getElementById('cancel-delete-btn').addEventListener('click', cancelDeleteAccount);

            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –≤—ã—Å–æ—Ç—ã textarea –ø—Ä–∏ –≤–≤–æ–¥–µ
            document.getElementById('message-input').addEventListener('input', function() {
                this.style.height = 'auto';
                this.style.height = (this.scrollHeight) + 'px';
            });

            // –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ Enter (—Å Shift+Enter –¥–ª—è –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏)
            document.getElementById('message-input').addEventListener('keydown', function(e) {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    sendMessage();
                }
            });

            // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
            document.querySelectorAll('.close-modal').forEach(btn => {
                btn.addEventListener('click', function() {
                    this.closest('.modal').style.display = 'none';
                });
            });

            // –î–µ–π—Å—Ç–≤–∏—è —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
            document.getElementById('block-user-btn').addEventListener('click', blockUser);
            document.getElementById('unblock-user-btn').addEventListener('click', unblockUser);
            document.getElementById('start-chat-btn').addEventListener('click', startChat);
            document.getElementById('delete-user-btn').addEventListener('click', showAdminDeleteModal);
        }

        // –†–µ–Ω–¥–µ—Ä –≤—ã–±–æ—Ä–∞ –∞–≤–∞—Ç–∞—Ä–æ–∫
        function renderAvatarSelector() {
            const avatarSelector = document.getElementById('avatar-selector');
            const postAvatarSelector = document.getElementById('post-avatar-selector');
            
            avatarSelector.innerHTML = '';
            postAvatarSelector.innerHTML = '';
            
            appData.avatars.forEach(avatar => {
                const avatarOption = document.createElement('div');
                avatarOption.className = 'avatar-option';
                avatarOption.textContent = avatar;
                avatarOption.addEventListener('click', function() {
                    document.querySelectorAll('.avatar-option').forEach(opt => opt.classList.remove('selected'));
                    this.classList.add('selected');
                    document.getElementById('profile-avatar-display').textContent = avatar;
                });
                avatarSelector.appendChild(avatarOption);
                
                const postAvatarOption = document.createElement('div');
                postAvatarOption.className = 'avatar-option';
                postAvatarOption.textContent = avatar;
                postAvatarOption.addEventListener('click', function() {
                    document.querySelectorAll('#post-avatar-selector .avatar-option').forEach(opt => opt.classList.remove('selected'));
                    this.classList.add('selected');
                });
                postAvatarSelector.appendChild(postAvatarOption);
            });
        }

        // –§—É–Ω–∫—Ü–∏—è –≤—Ö–æ–¥–∞
        function login() {
            const username = document.getElementById('login-username').value;
            const password = document.getElementById('login-password').value;
            const errorDiv = document.getElementById('login-error');
            
            if (!username || !password) {
                errorDiv.textContent = '–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è';
                return;
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ —É–¥–∞–ª–µ–Ω –ª–∏ –∞–∫–∫–∞—É–Ω—Ç
            if (appData.deletedUsers.includes(username)) {
                errorDiv.textContent = '–ê–∫–∫–∞—É–Ω—Ç –±—ã–ª —É–¥–∞–ª–µ–Ω';
                return;
            }
            
            const user = appData.users.find(u => u.username === username && u.password === password);
            
            if (user) {
                appData.currentUser = user;
                saveCurrentUser();
                showMainPages();
                errorDiv.textContent = '';
            } else {
                errorDiv.textContent = '–ù–µ–≤–µ—Ä–Ω—ã–π –ª–æ–≥–∏–Ω –∏–ª–∏ –ø–∞—Ä–æ–ª—å';
            }
        }

        // –§—É–Ω–∫—Ü–∏—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
        function register() {
            const username = document.getElementById('register-username').value;
            const password = document.getElementById('register-password').value;
            const confirm = document.getElementById('register-confirm').value;
            const errorDiv = document.getElementById('register-error');
            
            if (!username || !password || !confirm) {
                errorDiv.textContent = '–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è';
                return;
            }
            
            if (password !== confirm) {
                errorDiv.textContent = '–ü–∞—Ä–æ–ª–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç';
                return;
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ —É–¥–∞–ª–µ–Ω –ª–∏ –∞–∫–∫–∞—É–Ω—Ç —Å —Ç–∞–∫–∏–º –ª–æ–≥–∏–Ω–æ–º
            if (appData.deletedUsers.includes(username)) {
                errorDiv.textContent = '–≠—Ç–æ—Ç –ª–æ–≥–∏–Ω –±—ã–ª –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –≤ —É–¥–∞–ª–µ–Ω–Ω–æ–º –∞–∫–∫–∞—É–Ω—Ç–µ';
                return;
            }
            
            if (appData.users.find(u => u.username === username)) {
                errorDiv.textContent = '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º –ª–æ–≥–∏–Ω–æ–º —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç';
                return;
            }
            
            const newUser = {
                username,
                password,
                isAdmin: false,
                avatar: 'üò∫',
                description: '–ù–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å CatCityRP'
            };
            
            appData.users.push(newUser);
            saveUsers();
            
            appData.currentUser = newUser;
            saveCurrentUser();
            
            showMainPages();
            errorDiv.textContent = '';
        }

        // –§—É–Ω–∫—Ü–∏—è –≤—ã—Ö–æ–¥–∞
        function logout() {
            appData.currentUser = null;
            localStorage.removeItem('catcityrp_currentUser');
            showAuthPage();
        }

        // –†–µ–Ω–¥–µ—Ä –ø–æ—Å—Ç–æ–≤
        function renderPosts() {
            const postsContainer = document.getElementById('posts-container');
            postsContainer.innerHTML = '';
            
            if (appData.posts.length === 0) {
                postsContainer.innerHTML = '<p>–ü–æ–∫–∞ –Ω–µ—Ç –ø–æ—Å—Ç–æ–≤. –ë—É–¥—å—Ç–µ –ø–µ—Ä–≤—ã–º, –∫—Ç–æ —Å–æ–∑–¥–∞—Å—Ç –ø–æ—Å—Ç!</p>';
                return;
            }
            
            appData.posts.forEach((post, index) => {
                const postElement = document.createElement('div');
                postElement.className = 'post';
                
                const postHeader = document.createElement('div');
                postHeader.className = 'post-header';
                
                const postAvatar = document.createElement('div');
                postAvatar.className = 'post-avatar';
                postAvatar.textContent = post.avatar;
                
                const postTitle = document.createElement('div');
                postTitle.className = 'post-title';
                postTitle.textContent = post.title;
                
                postHeader.appendChild(postAvatar);
                postHeader.appendChild(postTitle);
                
                const postContent = document.createElement('div');
                postContent.className = 'post-content';
                postContent.textContent = post.content;
                
                const postActions = document.createElement('div');
                postActions.className = 'post-actions';
                
                const viewCommentsBtn = document.createElement('button');
                viewCommentsBtn.textContent = `–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ (${post.comments ? post.comments.length : 0})`;
                viewCommentsBtn.addEventListener('click', () => showPostModal(index));
                
                postActions.appendChild(viewCommentsBtn);
                
                if (appData.currentUser.isAdmin) {
                    const deletePostBtn = document.createElement('button');
                    deletePostBtn.textContent = '–£–¥–∞–ª–∏—Ç—å –ø–æ—Å—Ç';
                    deletePostBtn.style.background = '#ff4757';
                    deletePostBtn.addEventListener('click', () => deletePost(index));
                    postActions.appendChild(deletePostBtn);
                }
                
                postElement.appendChild(postHeader);
                postElement.appendChild(postContent);
                postElement.appendChild(postActions);
                
                postsContainer.appendChild(postElement);
            });
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ—Å—Ç–∞
        function showCreatePostModal() {
            if (!appData.currentUser.isAdmin) {
                alert('–§—É–Ω–∫—Ü–∏—è –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞');
                return;
            }
            
            document.getElementById('create-post-modal').style.display = 'flex';
            document.getElementById('post-title').value = '';
            document.getElementById('post-content').value = '';
            document.querySelectorAll('#post-avatar-selector .avatar-option').forEach(opt => opt.classList.remove('selected'));
        }

        // –°–æ–∑–¥–∞—Ç—å –ø–æ—Å—Ç
        function createPost() {
            const title = document.getElementById('post-title').value;
            const content = document.getElementById('post-content').value;
            const selectedAvatar = document.querySelector('#post-avatar-selector .avatar-option.selected');
            
            if (!title || !content || !selectedAvatar) {
                document.getElementById('post-error').textContent = '–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è –∏ –≤—ã–±–µ—Ä–∏—Ç–µ –∞–≤–∞—Ç–∞—Ä–∫—É';
                return;
            }
            
            const newPost = {
                title,
                content,
                avatar: selectedAvatar.textContent,
                author: appData.currentUser.username,
                date: new Date().toLocaleString(),
                comments: []
            };
            
            appData.posts.unshift(newPost);
            savePosts();
            
            document.getElementById('create-post-modal').style.display = 'none';
            document.getElementById('post-error').textContent = '';
            renderPosts();
        }

        // –£–¥–∞–ª–∏—Ç—å –ø–æ—Å—Ç
        function deletePost(index) {
            if (!appData.currentUser.isAdmin) {
                alert('–§—É–Ω–∫—Ü–∏—è –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞');
                return;
            }
            
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç –ø–æ—Å—Ç?')) {
                appData.posts.splice(index, 1);
                savePosts();
                renderPosts();
            }
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ—Å—Ç–∞ —Å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏
        function showPostModal(postIndex) {
            const post = appData.posts[postIndex];
            
            document.getElementById('modal-post-title').textContent = post.title;
            document.getElementById('modal-post-title-text').textContent = post.title;
            document.getElementById('modal-post-avatar').textContent = post.avatar;
            document.getElementById('modal-post-content').textContent = post.content;
            
            const commentsContainer = document.getElementById('post-comments');
            commentsContainer.innerHTML = '';
            
            if (post.comments && post.comments.length > 0) {
                post.comments.forEach((comment, commentIndex) => {
                    const commentElement = document.createElement('div');
                    commentElement.className = 'comment';
                    
                    const commentHeader = document.createElement('div');
                    commentHeader.className = 'comment-header';
                    
                    const commentAvatar = document.createElement('div');
                    commentAvatar.className = 'comment-avatar';
                    commentAvatar.textContent = comment.avatar;
                    
                    // –î–ª—è –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–æ–±–∞–≤–ª—è–µ–º –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–∫—Ä—ã—Ç—å –æ–∫–Ω–æ –¥–µ–π—Å—Ç–≤–∏–π –ø—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ –∞–≤–∞—Ç–∞—Ä
                    commentAvatar.addEventListener('click', () => showUserActions(comment.author));
                    
                    const commentAuthor = document.createElement('div');
                    commentAuthor.className = 'comment-author';
                    
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —É–¥–∞–ª–µ–Ω –ª–∏ –∞–≤—Ç–æ—Ä –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è
                    if (isUserDeleted(comment.author)) {
                        commentAuthor.innerHTML = `<span class="deleted-account">–£–¥–∞–ª–µ–Ω–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç</span>`;
                    } else {
                        commentAuthor.textContent = comment.author;
                        if (appData.users.find(u => u.username === comment.author && u.isAdmin)) {
                            const adminBadge = document.createElement('span');
                            adminBadge.className = 'admin-badge';
                            adminBadge.textContent = 'ADMIN';
                            commentAuthor.appendChild(adminBadge);
                        }
                    }
                    
                    commentHeader.appendChild(commentAvatar);
                    commentHeader.appendChild(commentAuthor);
                    
                    const commentContent = document.createElement('div');
                    commentContent.textContent = comment.text;
                    
                    commentElement.appendChild(commentHeader);
                    commentElement.appendChild(commentContent);
                    
                    if (appData.currentUser.isAdmin) {
                        const deleteCommentBtn = document.createElement('button');
                        deleteCommentBtn.textContent = '–£–¥–∞–ª–∏—Ç—å';
                        deleteCommentBtn.style.background = '#ff4757';
                        deleteCommentBtn.style.marginTop = '5px';
                        deleteCommentBtn.addEventListener('click', () => deleteComment(postIndex, commentIndex));
                        commentElement.appendChild(deleteCommentBtn);
                    }
                    
                    commentsContainer.appendChild(commentElement);
                });
            } else {
                commentsContainer.innerHTML = '<p>–ü–æ–∫–∞ –Ω–µ—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤. –ë—É–¥—å—Ç–µ –ø–µ—Ä–≤—ã–º!</p>';
            }
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–Ω–¥–µ–∫—Å –ø–æ—Å—Ç–∞ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è
            document.getElementById('submit-comment-btn').setAttribute('data-post-index', postIndex);
            
            document.getElementById('post-modal').style.display = 'flex';
        }

        // –î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
        function addComment() {
            const postIndex = document.getElementById('submit-comment-btn').getAttribute('data-post-index');
            const commentText = document.getElementById('comment-input').value;
            
            if (!commentText) {
                alert('–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è');
                return;
            }
            
            const newComment = {
                author: appData.currentUser.username,
                avatar: appData.currentUser.avatar,
                text: commentText,
                date: new Date().toLocaleString()
            };
            
            if (!appData.posts[postIndex].comments) {
                appData.posts[postIndex].comments = [];
            }
            
            appData.posts[postIndex].comments.push(newComment);
            savePosts();
            
            document.getElementById('comment-input').value = '';
            showPostModal(postIndex);
        }

        // –£–¥–∞–ª–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
        function deleteComment(postIndex, commentIndex) {
            if (!appData.currentUser.isAdmin) {
                alert('–§—É–Ω–∫—Ü–∏—è –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞');
                return;
            }
            
            appData.posts[postIndex].comments.splice(commentIndex, 1);
            savePosts();
            showPostModal(postIndex);
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å –¥–µ–π—Å—Ç–≤–∏—è —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
        function showUserActions(username) {
            if (username === appData.currentUser.username) return;
            
            document.getElementById('user-actions-modal').setAttribute('data-target-user', username);
            document.getElementById('user-actions-modal').style.display = 'flex';
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º/—Å–∫—Ä—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫–∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è
            const isBlocked = appData.blockedUsers[appData.currentUser.username] && 
                             appData.blockedUsers[appData.currentUser.username].includes(username);
            
            document.getElementById('block-user-btn').style.display = isBlocked ? 'none' : 'block';
            document.getElementById('unblock-user-btn').style.display = isBlocked ? 'block' : 'none';
            
            // –ö–Ω–æ–ø–∫–∞ "–ù–∞—á–∞—Ç—å –æ–±—â–µ–Ω–∏–µ" –≤—Å–µ–≥–¥–∞ –≤–∏–¥–Ω–∞
            document.getElementById('start-chat-btn').style.display = 'block';
            
            // –ö–Ω–æ–ø–∫–∞ "–£–¥–∞–ª–∏—Ç—å –∞–∫–∫–∞—É–Ω—Ç" –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∞–º
            if (appData.currentUser.isAdmin) {
                document.getElementById('delete-user-btn').style.display = 'block';
            } else {
                document.getElementById('delete-user-btn').style.display = 'none';
            }
        }

        // –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function blockUser() {
            const targetUser = document.getElementById('user-actions-modal').getAttribute('data-target-user');
            
            if (!appData.blockedUsers[appData.currentUser.username]) {
                appData.blockedUsers[appData.currentUser.username] = [];
            }
            
            if (!appData.blockedUsers[appData.currentUser.username].includes(targetUser)) {
                appData.blockedUsers[appData.currentUser.username].push(targetUser);
                saveBlockedUsers();
            }
            
            document.getElementById('user-actions-modal').style.display = 'none';
            alert(`–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ${targetUser} –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω`);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ –¥–∏–∞–ª–æ–≥–æ–≤
            renderConversations();
        }

        // –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function unblockUser() {
            const targetUser = document.getElementById('user-actions-modal').getAttribute('data-target-user');
            
            if (appData.blockedUsers[appData.currentUser.username] && 
                appData.blockedUsers[appData.currentUser.username].includes(targetUser)) {
                const index = appData.blockedUsers[appData.currentUser.username].indexOf(targetUser);
                appData.blockedUsers[appData.currentUser.username].splice(index, 1);
                saveBlockedUsers();
            }
            
            document.getElementById('user-actions-modal').style.display = 'none';
            alert(`–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ${targetUser} —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω`);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ –¥–∏–∞–ª–æ–≥–æ–≤
            renderConversations();
        }

        // –ù–∞—á–∞—Ç—å –æ–±—â–µ–Ω–∏–µ
        function startChat() {
            const targetUser = document.getElementById('user-actions-modal').getAttribute('data-target-user');
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
            if (isUserBlocked(targetUser)) {
                alert('–û–±—â–µ–Ω–∏–µ —Å —ç—Ç–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ');
                return;
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —É–∂–µ –±–µ—Å–µ–¥–∞
            let existingConversation = appData.conversations.find(conv => 
                (conv.user1 === appData.currentUser.username && conv.user2 === targetUser) ||
                (conv.user1 === targetUser && conv.user2 === appData.currentUser.username)
            );
            
            if (!existingConversation) {
                existingConversation = {
                    user1: appData.currentUser.username,
                    user2: targetUser,
                    messages: []
                };
                appData.conversations.push(existingConversation);
                saveConversations();
            }
            
            document.getElementById('user-actions-modal').style.display = 'none';
            
            // –ü–µ—Ä–µ—Ö–æ–¥–∏–º –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É —Å–æ–æ–±—â–µ–Ω–∏–π
            document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
            document.querySelector('[data-page="messages"]').classList.add('active');
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById('messages-page').classList.add('active');
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ –¥–∏–∞–ª–æ–≥–æ–≤
            renderConversations();
            
            // –û—Ç–∫—Ä—ã–≤–∞–µ–º —á–∞—Ç —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
            openChat(existingConversation, targetUser);
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —É–¥–∞–ª–µ–Ω–∏—è –∞–∫–∫–∞—É–Ω—Ç–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º
        function showAdminDeleteModal() {
            const targetUser = document.getElementById('user-actions-modal').getAttribute('data-target-user');
            document.getElementById('delete-confirm-text').textContent = 
                `–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –∞–∫–∫–∞—É–Ω—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ${targetUser}? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –æ—Ç–º–µ–Ω–∏—Ç—å.`;
            
            document.getElementById('confirm-delete-modal').setAttribute('data-target-user', targetUser);
            document.getElementById('confirm-delete-modal').setAttribute('data-delete-type', 'admin');
            document.getElementById('user-actions-modal').style.display = 'none';
            document.getElementById('confirm-delete-modal').style.display = 'flex';
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —É–¥–∞–ª–µ–Ω–∏—è —Å–≤–æ–µ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞
        function showDeleteAccountModal() {
            document.getElementById('delete-confirm-text').textContent = 
                `–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —Å–≤–æ–π –∞–∫–∫–∞—É–Ω—Ç? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –æ—Ç–º–µ–Ω–∏—Ç—å. –í—Å–µ –≤–∞—à–∏ –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç —É–¥–∞–ª–µ–Ω—ã.`;
            
            document.getElementById('confirm-delete-modal').setAttribute('data-target-user', appData.currentUser.username);
            document.getElementById('confirm-delete-modal').setAttribute('data-delete-type', 'self');
            document.getElementById('confirm-delete-modal').style.display = 'flex';
        }

        // –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å —É–¥–∞–ª–µ–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–∞
        function confirmDeleteAccount() {
            const targetUser = document.getElementById('confirm-delete-modal').getAttribute('data-target-user');
            const deleteType = document.getElementById('confirm-delete-modal').getAttribute('data-delete-type');
            
            // –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Å–ø–∏—Å–æ–∫ —É–¥–∞–ª–µ–Ω–Ω—ã—Ö
            if (!appData.deletedUsers.includes(targetUser)) {
                appData.deletedUsers.push(targetUser);
                saveDeletedUsers();
            }
            
            // –£–¥–∞–ª—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ —Å–ø–∏—Å–∫–∞ –∞–∫—Ç–∏–≤–Ω—ã—Ö
            const userIndex = appData.users.findIndex(u => u.username === targetUser);
            if (userIndex !== -1) {
                appData.users.splice(userIndex, 1);
                saveUsers();
            }
            
            // –£–¥–∞–ª—è–µ–º –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            if (appData.blockedUsers[targetUser]) {
                delete appData.blockedUsers[targetUser];
                saveBlockedUsers();
            }
            
            // –£–¥–∞–ª—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ —Å–ø–∏—Å–∫–æ–≤ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ –¥—Ä—É–≥–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
            Object.keys(appData.blockedUsers).forEach(username => {
                const index = appData.blockedUsers[username].indexOf(targetUser);
                if (index !== -1) {
                    appData.blockedUsers[username].splice(index, 1);
                }
            });
            saveBlockedUsers();
            
            // –£–¥–∞–ª—è–µ–º –¥–∏–∞–ª–æ–≥–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            appData.conversations = appData.conversations.filter(conv => 
                conv.user1 !== targetUser && conv.user2 !== targetUser
            );
            saveConversations();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ—Å—Ç—ã –∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
            appData.posts.forEach(post => {
                if (post.author === targetUser) {
                    post.author = '–£–¥–∞–ª–µ–Ω–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç';
                }
                if (post.comments) {
                    post.comments.forEach(comment => {
                        if (comment.author === targetUser) {
                            comment.author = '–£–¥–∞–ª–µ–Ω–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç';
                        }
                    });
                }
            });
            savePosts();
            
            document.getElementById('confirm-delete-modal').style.display = 'none';
            
            if (deleteType === 'self') {
                // –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–¥–∞–ª–∏–ª —Å–≤–æ–π –∞–∫–∫–∞—É–Ω—Ç, –≤—ã—Ö–æ–¥–∏–º –∏–∑ —Å–∏—Å—Ç–µ–º—ã
                alert('–í–∞—à –∞–∫–∫–∞—É–Ω—Ç –±—ã–ª —É–¥–∞–ª–µ–Ω');
                logout();
            } else {
                // –ï—Å–ª–∏ –∞–¥–º–∏–Ω —É–¥–∞–ª–∏–ª —á—É–∂–æ–π –∞–∫–∫–∞—É–Ω—Ç
                alert(`–ê–∫–∫–∞—É–Ω—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ${targetUser} –±—ã–ª —É–¥–∞–ª–µ–Ω`);
                renderPosts();
                renderConversations();
            }
        }

        // –û—Ç–º–µ–Ω–∏—Ç—å —É–¥–∞–ª–µ–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–∞
        function cancelDeleteAccount() {
            document.getElementById('confirm-delete-modal').style.display = 'none';
        }

        // –†–µ–Ω–¥–µ—Ä —Å–ø–∏—Å–∫–∞ –±–µ—Å–µ–¥
        function renderConversations() {
            const conversationsList = document.getElementById('conversations-list');
            const noConversations = document.getElementById('no-conversations');
            conversationsList.innerHTML = '';
            
            const userConversations = appData.conversations.filter(conv => 
                conv.user1 === appData.currentUser.username || conv.user2 === appData.currentUser.username
            ).filter(conv => {
                const otherUser = conv.user1 === appData.currentUser.username ? conv.user2 : conv.user1;
                return !isUserBlocked(otherUser) && !isUserDeleted(otherUser);
            });
            
            if (userConversations.length === 0) {
                conversationsList.style.display = 'none';
                noConversations.style.display = 'block';
                document.getElementById('no-chat-selected').style.display = 'flex';
                document.getElementById('active-chat').style.display = 'none';
                return;
            }
            
            conversationsList.style.display = 'block';
            noConversations.style.display = 'none';
            
            userConversations.forEach(conv => {
                const otherUser = conv.user1 === appData.currentUser.username ? conv.user2 : conv.user1;
                const userInfo = appData.users.find(u => u.username === otherUser);
                
                const conversationElement = document.createElement('div');
                conversationElement.className = 'message-user';
                if (appData.currentChat && appData.currentChat.user2 === otherUser) {
                    conversationElement.classList.add('active');
                }
                conversationElement.setAttribute('data-user', otherUser);
                
                const userAvatar = document.createElement('div');
                userAvatar.className = 'message-avatar';
                
                // –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–¥–∞–ª–µ–Ω, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –∞–≤–∞—Ç–∞—Ä
                if (isUserDeleted(otherUser)) {
                    userAvatar.textContent = 'üíÄ';
                } else if (userInfo) {
                    userAvatar.textContent = userInfo.avatar;
                    
                    // –î–ª—è –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–æ–±–∞–≤–ª—è–µ–º –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –¥–µ–π—Å—Ç–≤–∏–π –ø—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ –∞–≤–∞—Ç–∞—Ä
                    userAvatar.addEventListener('click', (e) => {
                        e.stopPropagation();
                        showUserActions(otherUser);
                    });
                }
                
                const userName = document.createElement('div');
                
                // –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–¥–∞–ª–µ–Ω, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–ø–µ—Ü–∏–∞–ª—å–Ω—É—é –Ω–∞–¥–ø–∏—Å—å
                if (isUserDeleted(otherUser)) {
                    userName.innerHTML = '<span class="deleted-account">–£–¥–∞–ª–µ–Ω–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç</span>';
                } else {
                    userName.textContent = otherUser;
                }
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –±–µ–π–¥–∂, –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω
                if (isUserBlocked(otherUser)) {
                    const blockedBadge = document.createElement('div');
                    blockedBadge.className = 'blocked-badge';
                    blockedBadge.textContent = '–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω';
                    conversationElement.appendChild(blockedBadge);
                }
                
                conversationElement.appendChild(userAvatar);
                conversationElement.appendChild(userName);
                
                // –ù–µ –ø–æ–∑–≤–æ–ª—è–µ–º –æ—Ç–∫—Ä—ã–≤–∞—Ç—å —á–∞—Ç —Å —É–¥–∞–ª–µ–Ω–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
                if (!isUserDeleted(otherUser)) {
                    conversationElement.addEventListener('click', () => openChat(conv, otherUser));
                }
                
                conversationsList.appendChild(conversationElement);
            });
        }

        // –û—Ç–∫—Ä—ã—Ç—å —á–∞—Ç —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
        function openChat(conversation, otherUser) {
            appData.currentChat = conversation;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –¥–∏–∞–ª–æ–≥ –≤ —Å–ø–∏—Å–∫–µ
            document.querySelectorAll('.message-user').forEach(el => {
                el.classList.remove('active');
                if (el.getAttribute('data-user') === otherUser) {
                    el.classList.add('active');
                }
            });
            
            document.getElementById('no-chat-selected').style.display = 'none';
            document.getElementById('active-chat').style.display = 'block';
            
            const userInfo = appData.users.find(u => u.username === otherUser);
            
            // –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–¥–∞–ª–µ–Ω, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–ø–µ—Ü–∏–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
            if (isUserDeleted(otherUser)) {
                document.getElementById('chat-user-info').innerHTML = `
                    <div class="chat-avatar">üíÄ</div>
                    <div class="deleted-account">–£–¥–∞–ª–µ–Ω–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç</div>
                `;
                // –°–∫—Ä—ã–≤–∞–µ–º –ø–æ–ª–µ –≤–≤–æ–¥–∞ –¥–ª—è —É–¥–∞–ª–µ–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
                document.querySelector('.chat-input').style.display = 'none';
            } else {
                document.getElementById('chat-user-info').innerHTML = `
                    <div class="chat-avatar">${userInfo.avatar}</div>
                    <div>${otherUser}</div>
                `;
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–ª–µ –≤–≤–æ–¥–∞ –¥–ª—è –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
                document.querySelector('.chat-input').style.display = 'flex';
                
                // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –Ω–∞ –∞–≤–∞—Ç–∞—Ä–∫—É –≤ —á–∞—Ç–µ
                const chatAvatar = document.querySelector('.chat-avatar');
                chatAvatar.addEventListener('click', () => {
                    showUserActions(otherUser);
                });
            }
            
            renderChatMessages(conversation);
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –≤—ã—Å–æ—Ç—É textarea
            const messageInput = document.getElementById('message-input');
            messageInput.style.height = '60px';
            messageInput.focus();
        }

        // –†–µ–Ω–¥–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —á–∞—Ç–µ
        function renderChatMessages(conversation) {
            const chatMessages = document.getElementById('chat-messages');
            chatMessages.innerHTML = '';
            
            if (conversation.messages.length === 0) {
                chatMessages.innerHTML = '<p style="text-align: center; padding: 20px; color: #aaa;">–ù–∞—á–Ω–∏—Ç–µ –æ–±—â–µ–Ω–∏–µ!</p>';
                return;
            }
            
            conversation.messages.forEach(message => {
                const messageElement = document.createElement('div');
                messageElement.className = `message ${message.sender === appData.currentUser.username ? 'own' : 'other'}`;
                
                const messageText = document.createElement('div');
                messageText.textContent = message.text;
                
                const messageTime = document.createElement('div');
                messageTime.className = 'message-time';
                messageTime.textContent = message.time;
                
                messageElement.appendChild(messageText);
                messageElement.appendChild(messageTime);
                
                chatMessages.appendChild(messageElement);
            });
            
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        // –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ
        function sendMessage() {
            if (!appData.currentChat) return;
            
            const messageInput = document.getElementById('message-input');
            const messageText = messageInput.value.trim();
            
            if (!messageText) return;
            
            const otherUser = appData.currentChat.user1 === appData.currentUser.username ? 
                            appData.currentChat.user2 : appData.currentChat.user1;
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (–¥–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω—è—è –ø—Ä–æ–≤–µ—Ä–∫–∞)
            if (isUserBlocked(otherUser)) {
                alert('–û–±—â–µ–Ω–∏–µ —Å —ç—Ç–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ');
                return;
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ —É–¥–∞–ª–µ–Ω –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
            if (isUserDeleted(otherUser)) {
                alert('–ù–µ–ª—å–∑—è –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è —É–¥–∞–ª–µ–Ω–Ω–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é');
                return;
            }
            
            const newMessage = {
                sender: appData.currentUser.username,
                text: messageText,
                time: new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})
            };
            
            appData.currentChat.messages.push(newMessage);
            saveConversations();
            
            messageInput.value = '';
            messageInput.style.height = '60px';
            renderChatMessages(appData.currentChat);
        }

        // –£–¥–∞–ª–∏—Ç—å —á–∞—Ç
        function deleteChat() {
            if (!appData.currentChat) return;
            
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç—É –±–µ—Å–µ–¥—É? –°–æ–æ–±—â–µ–Ω–∏—è –±—É–¥—É—Ç –±–µ–∑–≤–æ–∑–≤—Ä–∞—Ç–Ω–æ —É–¥–∞–ª–µ–Ω—ã.')) {
                const index = appData.conversations.indexOf(appData.currentChat);
                appData.conversations.splice(index, 1);
                saveConversations();
                
                appData.currentChat = null;
                document.getElementById('no-chat-selected').style.display = 'flex';
                document.getElementById('active-chat').style.display = 'none';
                renderConversations();
            }
        }

        // –†–µ–Ω–¥–µ—Ä –ø—Ä–æ—Ñ–∏–ª—è
        function renderProfile() {
            document.getElementById('profile-username').value = appData.currentUser.username;
            document.getElementById('profile-description').value = appData.currentUser.description || '';
            document.getElementById('profile-avatar-display').textContent = appData.currentUser.avatar;
            
            // –í—ã–¥–µ–ª—è–µ–º —Ç–µ–∫—É—â–∏–π –∞–≤–∞—Ç–∞—Ä
            document.querySelectorAll('.avatar-option').forEach(opt => {
                if (opt.textContent === appData.currentUser.avatar) {
                    opt.classList.add('selected');
                }
            });
        }

        // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å
        function saveProfile() {
            const description = document.getElementById('profile-description').value;
            const selectedAvatar = document.querySelector('.avatar-option.selected');
            
            if (!selectedAvatar) {
                document.getElementById('profile-message').textContent = '–í—ã–±–µ—Ä–∏—Ç–µ –∞–≤–∞—Ç–∞—Ä–∫—É';
                document.getElementById('profile-message').className = 'error';
                return;
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            const userIndex = appData.users.findIndex(u => u.username === appData.currentUser.username);
            if (userIndex !== -1) {
                appData.users[userIndex].description = description;
                appData.users[userIndex].avatar = selectedAvatar.textContent;
                saveUsers();
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                appData.currentUser.description = description;
                appData.currentUser.avatar = selectedAvatar.textContent;
                saveCurrentUser();
                
                document.getElementById('profile-message').textContent = '–ò–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã';
                document.getElementById('profile-message').className = 'success';
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –∞–≤–∞—Ç–∞—Ä–∫–∏ –≤ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è—Ö –∏ –ø–æ—Å—Ç–∞—Ö
                appData.posts.forEach(post => {
                    if (post.comments) {
                        post.comments.forEach(comment => {
                            if (comment.author === appData.currentUser.username) {
                                comment.avatar = selectedAvatar.textContent;
                            }
                        });
                    }
                });
                savePosts();
            }
        }

        // –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        initApp();
    </script>
</body>
</html>